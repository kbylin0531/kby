SELECT RTRIM(U.TEACHERNO) TEACHERNO,T.NAME,S.NAME SCHOOLNAME,SEXCODE.NAME SEX,P.[VALUE] [POSITION],RTRIM(U.ROLES) ROLES FROM USERS U
LEFT JOIN TEACHERS T ON T.TEACHERNO=U.TEACHERNO 
LEFT JOIN SCHOOLS S ON S.SCHOOL=T.SCHOOL 
LEFT JOIN SEXCODE ON SEXCODE.CODE=T.SEX 
LEFT JOIN POSITIONS P ON P.NAME=T.[POSITION] 
WHERE T.NAME LIKE :NAME AND U.TEACHERNO LIKE :TEACHERNO AND S.SCHOOL LIKE :SCHOOL
AND NOT EXISTS(SELECT * FROM USERS U2 WHERE U2.TEACHERNO=U.TEACHERNO AND U2.ROLES LIKE '%0%')
ORDER BY SCHOOLNAME