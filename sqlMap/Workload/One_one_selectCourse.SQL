select * from(select row_number() over(order by SCHEDULEPLAN.COURSENO) as row,
schedulePLAN.RECNO AS course_id,
workloadtype.worktype_code as code,
coursePLAN.COURSENO,
coursePLAN.[GROUP],
COURSES.COURSENAME,
COURSETYPEOPTIONS.VALUE as kclx,
COURSES.CREDITS as xf,
SCHOOLS.NAME as SCHOOL,
COURSES.HOURS as mzks,
case COURSES.Lhours  when 0.0 then 0
else COURSES.Lhours end as zjk,
COURSES.EXPERIMENTS as zsy,
COURSES.COMPUTING as zsj,
COURSES.KHOURS as zsx,
COURSES.SHOURS as ztl,
COURSES.ZHOURS as zzx,
COURSEAPPROACHES.VALUE AS xkfs
FROM SCHEDULEPLAN LEFT JOIN COURSES ON SCHEDULEPLAN.COURSENO=COURSES.COURSENO
inner join coursePLAN on (COURSEPLAN.courseno+COURSEPLAN.[group]=SCHEDULEPLAN.courseno+SCHEDULEPLAN.[group] and SCHEDULEPLAN.year=COURSEPLAN.year and SCHEDULEPLAN.term=COURSEPLAN.term)
left JOIN COURSETYPEOPTIONS ON COURSES.TYPE=COURSETYPEOPTIONS.NAME
left JOIN COURSEAPPROACHES ON COURSEAPPROACHES.NAME=COURSEPLAN.COURSETYPE
left JOIN SCHOOLS ON COURSES.SCHOOL=SCHOOLS.SCHOOL
left join workloadtype on workloadtype.worktype_code='M1'
WHERE SCHEDULEPLAN.COURSENO LIKE :COURSENO AND COURSES.COURSENAME LIKE :COURSENAME AND COURSES.TYPE LIKE :COURSETYPE
AND COURSEPLAN.COURSETYPE LIKE :XIUKETYPE AND SCHEDULEPLAN.YEAR=:YEAR AND SCHEDULEPLAN.TERM=:TERM and COURSEPLAN.SCHOOL like :CSCHOOL
GROUP BY SCHEDULEPLAN.COURSENO,SCHEDULEPLAN.RECNO,workloadtype.worktype_code,coursePLAN.COURSENO,coursePLAN.[GROUP],COURSES.COURSENAME,COURSETYPEOPTIONS.VALUE,
COURSES.CREDITS,SCHOOLS.NAME,COURSES.Lhours,COURSES.EXPERIMENTS,COURSES.COMPUTING,COURSES.KHOURS,COURSES.SHOURS,COURSES.ZHOURS,COURSEAPPROACHES.VALUE,COURSES.HOURS
) as b where b.row between :start and :end
