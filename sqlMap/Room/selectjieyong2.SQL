select * from(SELECT row_number() over(order by APPLYDATE DESC)as row,
RECNO,ROOMNO,JSN,EQUIPMENT,STATUS,RESERVED,DAY,TIME,OEW,WEEKS,SCHOOL,CONVERT(varchar(10),APPLYDATE,20) As APPLYDATE,USERNAME,APPROVED,PURPOSE FROM VIEWROOMLEASE
WHERE YEAR= :YEAR
AND TERM= :TERM
AND SCHOOLCODE LIKE :SCHOOL
AND ROOMNO LIKE :ROOMNO
AND (APPROVED= :APPROVED OR APPROVED= :NOTAPPROVED)
)as b where b.row between :start and :end
