select SCHEDULE.TIME+SCHEDULE.DAY+SCHEDULE.OEW AS TIME,
CASE WHEN TEACHERS.NAME  is NULL THEN RTRIM(COURSES.COURSENAME)+':'+SCHEDULE.COURSENO+SCHEDULE.[GROUP]
		WHEN TEACHERS.NAME  is not NULL THEN RTRIM(COURSES.COURSENAME)+':'+SCHEDULE.COURSENO+SCHEDULE.[GROUP]+'('+TEACHERS.NAME +')'
end as COURSE,
SCHEDULE.COURSENO AS COURSENO,
SCHEDULE.[GROUP] AS COURSEGROUP,
SCHEDULE.WEEKS AS WEEKS
FROM SCHEDULE JOIN COURSES ON SCHEDULE.COURSENO=COURSES.COURSENO
JOIN TEACHERPLAN ON SCHEDULE.MAP=TEACHERPLAN.RECNO
LEFT OUTER JOIN TEACHERS ON TEACHERPLAN.TEACHERNO=TEACHERS.TEACHERNO
WHERE SCHEDULE.YEAR=:year
AND SCHEDULE.TERM=:term
AND SCHEDULE.ROOMNO=:roomno
ORDER BY TIME
