select * from(
SELECT row_number() over(ORDER BY :order)as row,
ISNULL(TIMELIST.MON,0) AS MON,
ISNULL(TIMELIST.TUE,0) AS TUE,
ISNULL(TIMELIST.WES,0) AS WES,
ISNULL(TIMELIST.THU,0) AS THU,
ISNULL(TIMELIST.FRI,0) AS FRI,
ISNULL(TIMELIST.SAT,0) AS SAT,
ISNULL(TIMELIST.SUN,0) AS SUN,
CLASSROOMS.ROOMNO,CLASSROOMS.JSN,CLASSROOMS.SEATS,CLASSROOMS.TESTERS,CLASSROOMS.RESERVED
FROM CLASSROOMS LEFT OUTER JOIN TIMELIST
ON CLASSROOMS.ROOMNO=TIMELIST.WHO
WHERE
(ISNULL(TIMELIST.MON,0) & :MON =0)
AND (ISNULL(TIMELIST.TUE,0) & :TUE =0)
AND (ISNULL(TIMELIST.WES,0) & :WES =0)
AND (ISNULL(TIMELIST.THU,0) & :THU =0)
AND (ISNULL(TIMELIST.FRI,0) & :FRI =0)
AND (ISNULL(TIMELIST.SAT,0) & :SAT =0)
AND (ISNULL(TIMELIST.SUN,0) & :SUN =0)
AND CLASSROOMS.ROOMNO LIKE :ROOMNO
AND CLASSROOMS.JSN LIKE :JSN
AND CLASSROOMS.PRIORITY LIKE :SCHOOL
AND CLASSROOMS.EQUIPMENT LIKE :EQUIPMENT
AND CLASSROOMS.AREA LIKE :AREA
AND CLASSROOMS.SEATS >=:SEATSDOWN
AND CLASSROOMS.SEATS <=:SEATSUP
AND TIMELIST.YEAR=:YEAR
AND TIMELIST.TERM=:TERM
AND TIMELIST.TYPE=:TYPE
) as b where b.row between :start and :end