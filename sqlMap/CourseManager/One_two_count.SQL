select count(*) as ROWS from(SELECT distinct SCHEDULE.COURSENO+SCHEDULE.[GROUP] AS COURSENOGROUP,
COURSES.COURSENAME,
COURSETYPEOPTIONS.VALUE AS COURSETYPE,
SCHEDULE.ROOMNO,CLASSROOMS.JSN,SELECTION.ATTENDENTS,CLASSROOMS.SEATS
FROM SCHEDULE JOIN
(
	SELECT R32.YEAR,R32.TERM,R32.COURSENO+R32.[GROUP] AS COURSENOGROUP,
	COUNT(*) AS ATTENDENTS FROM R32
	GROUP BY R32.YEAR,R32.TERM,R32.COURSENO,R32.[GROUP]
)AS SELECTION ON SCHEDULE.YEAR=SELECTION.YEAR AND SCHEDULE.TERM=SELECTION.TERM
AND SCHEDULE.COURSENO+SCHEDULE.[GROUP]=SELECTION.COURSENOGROUP
JOIN CLASSROOMS ON SCHEDULE.ROOMNO=CLASSROOMS.ROOMNO
AND CLASSROOMS.SEATS<SELECTION.ATTENDENTS
JOIN COURSES ON SCHEDULE.COURSENO=COURSES.COURSENO
JOIN COURSETYPEOPTIONS ON COURSES.TYPE=COURSETYPEOPTIONS.NAME
WHERE SCHEDULE.YEAR=:YEAR
AND SCHEDULE.TERM=:TERM
) as b