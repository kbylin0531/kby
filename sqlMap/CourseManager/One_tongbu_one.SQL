UPDATE SCHEDULEPLAN SET ATTENDENTS=ISNULL(SELECTION.ATTENDENTS,0)
FROM SCHEDULEPLAN
LEFT OUTER JOIN
(
	SELECT R32.YEAR,R32.TERM,R32.COURSENO,R32.[GROUP],COUNT(*) AS ATTENDENTS
	FROM R32
	GROUP BY R32.YEAR,R32.TERM,R32.COURSENO,R32.[GROUP]
) AS SELECTION
ON SCHEDULEPLAN.YEAR=SELECTION.YEAR
AND SCHEDULEPLAN.TERM=SELECTION.TERM
AND SCHEDULEPLAN.COURSENO=SELECTION.COURSENO
AND SCHEDULEPLAN.[GROUP]=SELECTION.[GROUP]
WHERE SCHEDULEPLAN.YEAR=:YEAR
AND SCHEDULEPLAN.TERM=:TERM