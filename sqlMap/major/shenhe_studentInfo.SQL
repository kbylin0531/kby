SELECT STUDENTS.STUDENTNO xh,
rtrim(CLASSES.CLASSNAME) bj,
 STUDENTS.NAME xm,SUM(TEMP.CREDITS) AS zxf
FROM STUDENTS INNER JOIN CLASSES ON CLASSES.CLASSNO=STUDENTS.CLASSNO
 INNER JOIN (
 
 SELECT DISTINCT COURSES.CREDITS,SCORES.COURSENO ,SCORES.STUDENTNO
 FROM COURSES INNER JOIN SCORES ON SCORES.COURSENO=COURSES.COURSENO
 WHERE SCORES.STUDENTNO LIKE :studentno AND (SCORES.EXAMSCORE >= 60 OR SCORES.EXAMSCORE2 >= 60
 OR SCORES.TESTSCORE IN ('优秀', '良好', '及格', '中等', '合格')
 OR SCORES.TESTSCORE2 IN ('优秀','良好', '及格', '中等', '合格')) 
 
 )
 TEMP ON TEMP.STUDENTNO=STUDENTS.STUDENTNO
  WHERE STUDENTS.CLASSNO LIKE :classno   
  
  GROUP BY STUDENTS.STUDENTNO, CLASSES.CLASSNAME, STUDENTS.NAME ORDER BY bj,xh
