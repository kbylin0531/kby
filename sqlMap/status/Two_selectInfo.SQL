select * from(SELECT row_number() over(order by STUDENTS.CLASSNO,STUDENTS.STUDENTNO)as row,STUDENTS.STUDENTNO, STUDENTS.NAME, SexCode.NAME AS SEX,
      CONVERT(varchar(10),STUDENTS.ENTERDATE,20)AS ENTERDATE,STUDENTS.YEARS, STUDENTS.CLASSNO, STUDENTS.REG,
      STUDENTS.WARN, STUDENTS.STATUS, STUDENTS.GRADE, STUDENTS.SCHOOL,
      STUDENTS.OLDSTUDENTNO,
      CLASSES.CLASSNAME, SCHOOLS.NAME AS SCHOOLNAME,
      STATUSOPTIONS.VALUE AS STATUSVALUE,CONVERT(varchar(10),PERSONAL.BIRTHDAY,20)as BIRTHDAY,
      NATIONALITYCODE.NAME AS minzu, PARTYCODE.NAME AS zhengzhimm,
      PERSONAL.EXAMNO, PERSONAL.POSTCODE, PERSONAL.ADDRESS, PERSONAL.TEL,
      PERSONAL.MIDSCHOOL, PERSONAL.SCORE, PERSONAL.ID
FROM STUDENTS INNER JOIN
      PERSONAL ON STUDENTS.STUDENTNO = PERSONAL.studentno LEFT OUTER JOIN
      NATIONALITYCODE ON
      PERSONAL.NATIONALITY = NATIONALITYCODE.CODE LEFT OUTER JOIN
      PARTYCODE ON PERSONAL.PARTY = PARTYCODE.CODE LEFT OUTER JOIN
      CLASSES ON STUDENTS.CLASSNO = CLASSES.CLASSNO LEFT OUTER JOIN
      SCHOOLS ON STUDENTS.SCHOOL = SCHOOLS.SCHOOL LEFT OUTER JOIN
      STATUSOPTIONS ON
      STUDENTS.STATUS = STATUSOPTIONS.NAME LEFT OUTER JOIN
      SexCode ON STUDENTS.SEX = SexCode.CODE
where RTRIM(STUDENTS.StudentNo) LIKE :StudentNo
and STUDENTS.OLDSTUDENTNO like :oldstudentno
and STUDENTS.Name like :Name
and STUDENTS.ClassNo like :ClassNo
and STUDENTS.School like :School
and STUDENTS.Status like :Status
 )as b where b.row between :start and :end