insert into TestStudent(CourseNo,Studentno,Flag,Lock,CourseNo2)
SELECT scores.COURSENO,STUDENTS.STUDENTNO,0,0,scores.COURSENO
FROM SCORES LEFT OUTER JOIN
      COURSES ON
      SCORES.COURSENO = COURSES.COURSENO LEFT OUTER JOIN
      SCHOOLS ON COURSES.SCHOOL = SCHOOLS.SCHOOL LEFT OUTER JOIN
      STUDENTS ON SCORES.STUDENTNO = STUDENTS.STUDENTNO LEFT OUTER JOIN
      SCHOOLS SCHOOLS1 ON
      STUDENTS.SCHOOL = SCHOOLS1.SCHOOL LEFT OUTER JOIN
      EXAMREMOPTIONS ON SCORES.EXAMREM = EXAMREMOPTIONS.CODE
WHERE (SCORES.EXAMREM = 'D' or SCORES.EXAMREM = 'Q') and year=:YEAR and term=:TERM
AND NOT EXISTS (
	 select * from TestStudent as T WHERE T.STUDENTNO=SCORES.STUDENTNO AND T.COURSENO=SCORES.COURSENO
)
