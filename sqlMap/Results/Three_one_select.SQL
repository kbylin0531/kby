SELECT * from
  (SELECT row_number() over(ORDER BY t_courseno) AS ROW,
			t_courseno AS kh, t_coursename AS kcmc, t_appro AS xkfs, t_examoption AS khfs, CASE [t_status] WHEN 0 THEN '开放' ELSE '锁定' END AS zt,'' AS SL
   FROM
     ( SELECT COURSEPLAN.COURSENO + COURSEPLAN.[GROUP] AS t_courseno, COURSES.COURSENAME AS t_coursename, COURSEAPPROACHES.[VALUE] AS t_appro, EXAMOPTIONS.[VALUE] AS t_examoption, SUM(LOCK) AS t_status
      FROM COURSEPLAN
      INNER JOIN COURSEAPPROACHES ON COURSEPLAN.COURSETYPE = COURSEAPPROACHES.NAME
      INNER JOIN COURSES ON COURSES.COURSENO = COURSEPLAN.COURSENO
      INNER JOIN EXAMOPTIONS ON EXAMOPTIONS.NAME = COURSEPLAN.EXAMTYPE
      INNER JOIN SCORES ON SCORES.[YEAR] = COURSEPLAN.[YEAR] AND SCORES.TERM = COURSEPLAN.TERM AND COURSEPLAN.COURSENO = SCORES.COURSENO AND SCORES.[GROUP] = COURSEPLAN.[GROUP]
        where scores.year=:YEAR and scores.term=:TERM and courseplan.school=:SCHOOL
            and scores.[group] not in ('BY','ZX')
        GROUP BY COURSEPLAN.COURSENO + COURSEPLAN.[GROUP],
              COURSES.COURSENAME, COURSEAPPROACHES.[VALUE],
              EXAMOPTIONS.[VALUE]) AS TEMP
) as b where b.row between :start and :end

