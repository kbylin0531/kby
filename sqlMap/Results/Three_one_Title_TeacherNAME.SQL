select dbo.GROUP_CONCAT_MERGE(b.TEACHERNAME,',') as TEACHERNAME from(SELECT distinct teachers.teacherno as teacherno,TEACHERS.NAME AS TEACHERNAME,isnull(scheduleplan.ps,0) as ps,
100-isnull(scheduleplan.ps,0) as qm
FROM SCHEDULEPLAN
JOIN TEACHERPLAN ON SCHEDULEPLAN.RECNO=TEACHERPLAN.MAP
JOIN TEACHERS ON TEACHERPLAN.TEACHERNO=TEACHERS.TEACHERNO
LEFT OUTER JOIN TASKOPTIONS ON TEACHERPLAN.TASK=TASKOPTIONS.CODE
WHERE SCHEDULEPLAN.YEAR=:YEAR
AND SCHEDULEPLAN.TERM=:TERM
AND SCHEDULEPLAN.COURSENO+SCHEDULEPLAN.[GROUP]=:COURSENO
) as b