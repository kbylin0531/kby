select * from (select row_number() over(order by b.ROOMNAME,b.DAY,b.TIMESECTION,b.COURSENAME) as row,
b.COURSENO,b.COURSENAME,b.DAY,b.TIMESECTION,b.ROOMNAME,b.OEW,b.TEACHERNAME,b.SCHOOL,b.WEEKS,b.CLASSNAME from(SELECT distinct
SCHEDULE.COURSENO + SCHEDULE.[GROUP] as COURSENO,
    RTRIM(COURSES.COURSENAME) AS COURSENAME,
    SCHEDULE.DAY AS DAY,
        RTRIM(TIMESECTIONS.VALUE) AS TIMESECTION,
       RTRIM(CLASSROOMS.JSN) AS ROOMNAME,
       OEWOPTIONS.NAME AS OEW,
      RTRIM(TEACHERS.NAME) AS TEACHERNAME,
      RTRIM(SCHOOLS.NAME) AS SCHOOL,
      SCHEDULE.WEEKS AS WEEKS,
      CLASSQUERY.CLASSNAME AS CLASSNAME
FROM (SELECT COURSEPLAN.COURSENO + COURSEPLAN.[GROUP] AS COURSENOGROUP,
               CLASSES.CLASSNAME AS CLASSNAME
        FROM COURSEPLAN JOIN
              CLASSES ON COURSEPLAN.CLASSNO = CLASSES.CLASSNO
        WHERE COURSEPLAN.YEAR =:YONE AND COURSEPLAN.TERM =:TONE)
      CLASSQUERY RIGHT OUTER JOIN
      CLASSROOMS RIGHT OUTER JOIN
      TIMESECTIONS RIGHT OUTER JOIN
      TEACHERS RIGHT OUTER JOIN
      SCHEDULE INNER JOIN
      SCHEDULEPLAN ON SCHEDULE.YEAR = SCHEDULEPLAN.YEAR AND
      SCHEDULE.TERM = SCHEDULEPLAN.TERM AND
      SCHEDULE.COURSENO = SCHEDULEPLAN.COURSENO AND
      SCHEDULE.[GROUP] = SCHEDULEPLAN.[GROUP] INNER JOIN
      TEACHERPLAN ON SCHEDULEPLAN.RECNO = TEACHERPLAN.MAP ON
      TEACHERS.TEACHERNO = TEACHERPLAN.TEACHERNO LEFT OUTER JOIN
      POSITIONS ON TEACHERS.POSITION = POSITIONS.NAME LEFT OUTER JOIN
      SCHOOLS ON TEACHERS.SCHOOL = SCHOOLS.SCHOOL LEFT OUTER JOIN
      COURSES ON SCHEDULE.COURSENO = COURSES.COURSENO ON
      TIMESECTIONS.NAME = SCHEDULE.TIME LEFT OUTER JOIN
      OEWOPTIONS ON SCHEDULE.OEW = OEWOPTIONS.CODE ON
      CLASSROOMS.ROOMNO = SCHEDULE.ROOMNO ON
      CLASSQUERY.COURSENOGROUP = SCHEDULE.COURSENO + SCHEDULE.[GROUP]
WHERE SCHEDULE.YEAR=:YTWO
AND SCHEDULE.TERM=:TTWO
AND SCHEDULE.DAY<>0
AND SCHEDULE.DAY IS NOT NULL
AND SCHEDULE.TIME<>'0'
AND SCHEDULE.TIME IS NOT NULL
AND SCHEDULE.ROOMNO LIKE :ROOMNO
AND SCHEDULE.DAY LIKE :DAY
AND COURSES.SCHOOL LIKE :SCHOOL
) as b ) c where c.row between :start and :end